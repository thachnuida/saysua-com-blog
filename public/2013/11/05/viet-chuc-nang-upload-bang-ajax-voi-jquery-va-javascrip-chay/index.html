<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Viết chức năng upload bằng ajax với jquery và javascript chay | Saysua Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Trong bài viết này, tôi sẽ chỉ ra hai cách để tạo ajax upload. Cách thứ nhất sử dụng Jquery cùng với plugin Form Plugin của nó và cách thứ hai dành cho bạn nào muốn mày mò vọc code để tự mình viết riê">
<meta name="keywords" content="Jquery,Ajax">
<meta property="og:type" content="article">
<meta property="og:title" content="Viết chức năng upload bằng ajax với jquery và javascript chay">
<meta property="og:url" content="http://saysua.com/2013/11/05/viet-chuc-nang-upload-bang-ajax-voi-jquery-va-javascrip-chay/index.html">
<meta property="og:site_name" content="Saysua Blog">
<meta property="og:description" content="Trong bài viết này, tôi sẽ chỉ ra hai cách để tạo ajax upload. Cách thứ nhất sử dụng Jquery cùng với plugin Form Plugin của nó và cách thứ hai dành cho bạn nào muốn mày mò vọc code để tự mình viết riê">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://saysua.com/images/uploadfile.PNG">
<meta property="og:updated_time" content="2018-09-06T08:45:44.254Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Viết chức năng upload bằng ajax với jquery và javascript chay">
<meta name="twitter:description" content="Trong bài viết này, tôi sẽ chỉ ra hai cách để tạo ajax upload. Cách thứ nhất sử dụng Jquery cùng với plugin Form Plugin của nó và cách thứ hai dành cho bạn nào muốn mày mò vọc code để tự mình viết riê">
<meta name="twitter:image" content="http://saysua.com/images/uploadfile.PNG">
  
  
  <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/css/style.css">
  
<!-- Google Analytics -->
<script type="text/javascript">
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-42370265-1', 'auto');
ga('send', 'pageview');

</script>
<!-- End Google Analytics -->


   
  <link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
  <style type="text/css">
  #mc_embed_signup{clear:left; font:14px Helvetica,Arial,sans-serif; }
  #mc_embed_signup form {padding: 0px;}
  #mc_embed_signup .button {    background-color: #26C9FF;}
  /* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
     We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
  
</head>
<body>
  <div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) return;
  js = d.createElement(s); js.id = id;
  js.src = "//connect.facebook.net/en_US/sdk.js#xfbml=1&version=v2.4&appId=166177166899797";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">
          <img class="author-avatar"/>
          <div class="text">Saysua Blog</div>
        </a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
          <nav id="main-nav">
  <a id="main-nav-toggle" class="nav-icon"></a>
  
    <a class="main-nav-link" href="/">Home</a>
  
    <a class="main-nav-link" href="http://app.saysua.com">Apps</a>
  
    <a class="main-nav-link" href="/about">About</a>
  
</nav>
          <div class="content">
            <article id="post-viet-chuc-nang-upload-bang-ajax-voi-jquery-va-javascrip-chay" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2013/11/05/viet-chuc-nang-upload-bang-ajax-voi-jquery-va-javascrip-chay/" class="article-date">
  <time datetime="2013-11-04T23:43:31.000Z" itemprop="datePublished">2013-11-05</time>
</a>
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Viết chức năng upload bằng ajax với jquery và javascript chay
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Trong bài viết này, tôi sẽ chỉ ra hai cách để tạo ajax upload. Cách thứ nhất sử dụng Jquery cùng với plugin <a href="http://jquery.malsup.com/form/#file-upload" target="_blank" rel="noopener">Form Plugin</a> của nó và cách thứ hai dành cho bạn nào muốn mày mò vọc code để tự mình viết riêng phần upload chỉ dùng javacript. Ở bài viết này, tôi sử dụng PHP để viết phần server.</p>
<a id="more"></a>
<h1 id="File-xu-ly-server"><a href="#File-xu-ly-server" class="headerlink" title="File xử lý server"></a>File xử lý server</h1><p>Để cho đơn giản, nhiệm vụ của file phía server ở đây chỉ bắt file được upload lên, lưu vào thư mục upload  và trả về thông tin của file.</p>
<figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="xml"><span class="php"><span class="meta">&lt;?php</span></span></span></span><br><span class="line"><span class="xml">if ($_FILES["file"]["error"] &gt;</span> 0) &#123;</span><br><span class="line">  echo "Error: " . $_FILES[<span class="string">"file"</span>][<span class="symbol">"error"</span>] . "<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span>";</span><br><span class="line">&#125;</span><br><span class="line">else &#123;</span><br><span class="line">  echo "Upload: " . $_FILES[<span class="string">"file"</span>][<span class="symbol">"name"</span>] . "<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span>";</span><br><span class="line">  echo "Type: " . $_FILES[<span class="string">"file"</span>][<span class="symbol">"type"</span>] . "<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span>";</span><br><span class="line">  echo "Size: " . ($_FILES[<span class="string">"file"</span>][<span class="symbol">"size"</span>] / 1024) . " kB<span class="xml"><span class="tag">&lt;<span class="name">br</span>&gt;</span></span>";</span><br><span class="line">  echo "Stored in: " . $<span class="emphasis">_FILES["file"]["tmp_</span>name"];</span><br><span class="line"></span><br><span class="line">  // Save file</span><br><span class="line">  move<span class="emphasis">_uploaded_</span>file($<span class="emphasis">_FILES["file"]["tmp_</span>name"], "upload/" . $_FILES[<span class="string">"file"</span>][<span class="symbol">"name"</span>]);</span><br><span class="line">  echo "Stored in: " . "upload/" . $_FILES[<span class="string">"file"</span>][<span class="symbol">"name"</span>];</span><br><span class="line">&#125;</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>
<h1 id="Ajax-upload-bang-Form-Plugin"><a href="#Ajax-upload-bang-Form-Plugin" class="headerlink" title="Ajax upload bằng Form Plugin"></a>Ajax upload bằng Form Plugin</h1><p>Để sử dụng Jquery Form Plugin, trước tiên ta cần tải nó về tại đây <a href="http://jquery.malsup.com/form/#download" target="_blank" rel="noopener">http://jquery.malsup.com/form/#download</a>. Ở trang này các bạn cũng có thể xem thêm những ví dụ của nó, và để ý rằng plugin này không chỉ hữu ích cho việc upload file mà còn có thể xử dụng cho form ajax submit. Tuy nhiên ở đây tôi chỉ trình bày về ajax upload. Sau đó, ta nhúng thư viện Jquery và plugin Form mới tải về vào trang web. Cuối cùng, ta sử dụng phương thức ajaxForm  cho form cần thêm chức năng ajax upload. Mọi thao tác trên được thể hiện như đoạn code dưới đây.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!doctype html&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"en"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">title</span>&gt;</span>Ajax upload using plugin<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"js/jquery.form.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="css">    <span class="selector-id">#form-upload</span> &#123; <span class="attribute">padding</span>: <span class="number">10px</span>; <span class="attribute">background</span>: <span class="number">#A5CCFF</span>; <span class="attribute">border-radius</span>: <span class="number">5px</span>;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#progress</span> &#123; <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#ccc</span>; <span class="attribute">width</span>: <span class="number">500px</span>; <span class="attribute">height</span>: <span class="number">20px</span>; <span class="attribute">margin-top</span>: <span class="number">10px</span>;<span class="attribute">text-align</span>: center;<span class="attribute">position</span>: relative;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#bar</span> &#123; <span class="attribute">background</span>: <span class="number">#F39A3A</span>; <span class="attribute">height</span>: <span class="number">20px</span>; <span class="attribute">width</span>: <span class="number">0px</span>;&#125;</span></span><br><span class="line"><span class="css">    <span class="selector-id">#percent</span> &#123; <span class="attribute">position</span>: absolute; <span class="attribute">left</span>: <span class="number">50%</span>; <span class="attribute">top</span>: <span class="number">0px</span>;&#125;</span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>Upload file using Form plugin<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"form-upload"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">action</span>=<span class="string">"file.php"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span> <span class="attr">name</span>=<span class="string">"file"</span> <span class="attr">id</span>=<span class="string">"select-file"</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"Upload"</span> <span class="attr">id</span>=<span class="string">"submit-upload"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"progress"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"bar"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"percent"</span>&gt;</span>0%<span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"result"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  $(<span class="string">'#form-upload'</span>).ajaxForm(&#123;</span></span><br><span class="line"><span class="actionscript">    complete: <span class="function"><span class="keyword">function</span><span class="params">(xhr)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">// Add response text to div #result</span></span></span><br><span class="line"><span class="javascript">      $(<span class="string">'#result'</span>).html(xhr.responseText);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="undefined">  &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h2 id="Hien-thi-them-upload-file"><a href="#Hien-thi-them-upload-file" class="headerlink" title="Hiển thị thêm % upload file"></a>Hiển thị thêm % upload file</h2><p>Trong lúc upload file, để hiển thị thêm % upload file, ta thêm một vài đoạn code ngắn vào phần javascript như sau, đoạn code thêm vào sẽ xử lý tính % upload khi ta đang upload file:</p>
<p><img src="/images/uploadfile.PNG" alt="Giao dien upload"></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> bar = $(<span class="string">'#bar'</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> percent = $(<span class="string">'#percent'</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> result = $(<span class="string">'#result'</span>);</span></span><br><span class="line"><span class="actionscript">  <span class="keyword">var</span> percentValue = <span class="string">"0%"</span>;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  $(<span class="string">'#form-upload'</span>).ajaxForm(&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="comment">// Do something before uploading</span></span></span><br><span class="line"><span class="actionscript">      beforeUpload: <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="undefined">        result.empty();</span></span><br><span class="line"><span class="actionscript">        percentValue = <span class="string">"0%"</span>;</span></span><br><span class="line"><span class="undefined">        bar.width = percentValue;</span></span><br><span class="line"><span class="undefined">        percent.html(percentValue);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">      <span class="comment">// Do somthing while uploading</span></span></span><br><span class="line"><span class="actionscript">      uploadProgress: <span class="function"><span class="keyword">function</span><span class="params">(event, position, total, percentComplete)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> percentValue = percentComplete + <span class="string">'%'</span>;</span></span><br><span class="line"><span class="undefined">        bar.width(percentValue)</span></span><br><span class="line"><span class="undefined">        percent.html(percentValue);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">      <span class="comment">// Do something while uploading file finish</span></span></span><br><span class="line"><span class="actionscript">      success: <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> percentValue = <span class="string">'100%'</span>;</span></span><br><span class="line"><span class="undefined">        bar.width(percentValue)</span></span><br><span class="line"><span class="undefined">        percent.html(percentValue);</span></span><br><span class="line"><span class="undefined">      &#125;,</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">      <span class="comment">// Add response text to div #result when uploading complete</span></span></span><br><span class="line"><span class="actionscript">      complete: <span class="function"><span class="keyword">function</span><span class="params">(xhr)</span> </span>&#123;</span></span><br><span class="line"><span class="javascript">        $(<span class="string">'#result'</span>).html(xhr.responseText);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">  &#125;);</span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<h1 id="Tu-viet-phan-ajax-upload"><a href="#Tu-viet-phan-ajax-upload" class="headerlink" title="Tự viết phần ajax upload"></a>Tự viết phần ajax upload</h1><p>Ở phần này dành cho bạn nào muốn biết nếu không sử dụng plugin thì ta có thể tự viết được chức năng upload bằng ajax hay không? Tất nhiên là được. Ta sẽ sử dụng đến FormData  và XMLHttpRequest  để xử lý. Đoạn code dưới đây sẽ chỉ rõ hơn cho bạn thấy, với phần mã HTML giống như phần trên.</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> bar = <span class="built_in">document</span>.getElementById(<span class="string">'bar'</span>)</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> percent = <span class="built_in">document</span>.getElementById(<span class="string">'percent'</span>)</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> result = <span class="built_in">document</span>.getElementById(<span class="string">'result'</span>)</span></span><br><span class="line"><span class="actionscript">  <span class="keyword">var</span> percentValue = <span class="string">"0%"</span>;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> fileInput = <span class="built_in">document</span>.getElementById(<span class="string">'select-file'</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> form = <span class="built_in">document</span>.getElementById(<span class="string">'form-upload'</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">  form.addEventListener(<span class="string">'submit'</span>, <span class="function"><span class="keyword">function</span><span class="params">(evt)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">    <span class="comment">// Chan khong cho form tao submit</span></span></span><br><span class="line"><span class="undefined">    evt.preventDefault();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    <span class="comment">// Ajax upload</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> file = fileInput.files[<span class="number">0</span>];</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    <span class="comment">// fd dung de luu gia tri goi len</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> fd = <span class="keyword">new</span> FormData();</span></span><br><span class="line"><span class="actionscript">    fd.append(<span class="string">'file'</span>, file);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    <span class="comment">// xhr dung de goi data bang ajax</span></span></span><br><span class="line"><span class="actionscript">    <span class="keyword">var</span> xhr = <span class="keyword">new</span> XMLHttpRequest();</span></span><br><span class="line"><span class="actionscript">    xhr.open(<span class="string">'POST'</span>, <span class="string">'file.php'</span>, <span class="literal">true</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    xhr.upload.onprogress = <span class="function"><span class="keyword">function</span><span class="params">(e)</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">if</span> (e.lengthComputable) &#123;</span></span><br><span class="line"><span class="actionscript">        <span class="keyword">var</span> percentValue = (e.loaded / e.total) * <span class="number">100</span> + <span class="string">'%'</span>;</span></span><br><span class="line"><span class="undefined">        percent.innerHTML  = percentValue;</span></span><br><span class="line"><span class="actionscript">        bar.setAttribute(<span class="string">'style'</span>, <span class="string">'width: '</span> + percentValue);</span></span><br><span class="line"><span class="undefined">      &#125;</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">    xhr.onload = <span class="function"><span class="keyword">function</span><span class="params">()</span> </span>&#123;</span></span><br><span class="line"><span class="actionscript">      <span class="keyword">if</span> (<span class="keyword">this</span>.status == <span class="number">200</span>) &#123;</span></span><br><span class="line"><span class="actionscript">        result.innerHTML = <span class="keyword">this</span>.response;</span></span><br><span class="line"><span class="undefined">      &#125;;</span></span><br><span class="line"><span class="undefined">    &#125;;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    xhr.send(fd);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="actionscript">  &#125;, <span class="literal">false</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>
<p>Rõ ràng là việc không sử dụng plugin thì ta phải tự tay xử lý nhiều hơn, tuy nhiên với việc biết được bản chất của nó thì cũng thú vị. Nếu bạn thấy bài viết này bổ ích thì hãy chia sẻ cho bạn bè cùng đọc nhé.</p>
<h1 id="Source-Code"><a href="#Source-Code" class="headerlink" title="Source Code"></a>Source Code</h1><p>Toàn bộ souce code đầy đủ của bài viết, các bạn có thể xem lấy về tại đây <a href="https://github.com/thachnuida/ajax-upload-demo" target="_blank" rel="noopener">https://github.com/thachnuida/ajax-upload-demo</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://saysua.com/2013/11/05/viet-chuc-nang-upload-bang-ajax-voi-jquery-va-javascrip-chay/" data-id="cjlqbzfs4001tl4h1alf2vhq8" class="article-share-link">Share</a>
      
        <a href="http://saysua.com/2013/11/05/viet-chuc-nang-upload-bang-ajax-voi-jquery-va-javascrip-chay/#disqus_thread" class="article-comment-link">Comments</a>
      
      <div class="tagcloud">
        
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Ajax/">Ajax</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Jquery/">Jquery</a></li></ul>

      </div>
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2013/12/07/quan-ly-cac-goi-thu-vien-phia-client-site-bang-bower/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Quản lý các gói thư viện phía client site bằng Bower
        
      </div>
    </a>
  
  
    <a href="/2013/10/24/bat-su-kien-kich-chuot-ben-ngoai-mot-phan-tu-va-kiem-tra-phan-tu-anhien-bang-jquery/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Bắt sự kiện kích chuột bên ngoài một phần tử và kiểm tra phần tử ẩn/hiện bằng JQuery</div>
    </a>
  
</nav>

  
</article>

<hr>


<section id="comments">
  <div id="disqus_thread">
    <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  </div>
</section>


          </div>
        </section>
        
          <aside id="sidebar">
  
    <div class="widget-wrap">
  <h3 class="widget-title">Like my blog?</h3>
    <div class="widget">
        <div id="mc_embed_signup">
            <form action="//saysua.us13.list-manage.com/subscribe/post?u=f73e6f67cd2f017d41a3e3d41&amp;id=f866d9a20e" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate="novalidate">
                <div id="mc_embed_signup_scroll">
            <div class="mc-field-group">
                <label>Enter your email to subscribe my blog.</label>
                <input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL" placeholder="Your email address" aria-required="true">
            </div>
                <div id="mce-responses" class="clear">
                    <div class="response" id="mce-error-response" style="display:none"></div>
                    <div class="response" id="mce-success-response" style="display:none"></div>
                </div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
                <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_f73e6f67cd2f017d41a3e3d41_f866d9a20e" tabindex="-1" value=""></div>
                <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
                </div>
            </form>
        </div>
    </div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Labels</h3>
    <div class="widget tagcloud">
      <a href="/tags/Ajax/" style="font-size: 12px;">Ajax</a> <a href="/tags/Angular2/" style="font-size: 18px;">Angular2</a> <a href="/tags/Angularjs/" style="font-size: 14px;">Angularjs</a> <a href="/tags/Bower/" style="font-size: 12px;">Bower</a> <a href="/tags/Elastic-search/" style="font-size: 12px;">Elastic search</a> <a href="/tags/Facebook/" style="font-size: 12px;">Facebook</a> <a href="/tags/Godaddy/" style="font-size: 12px;">Godaddy</a> <a href="/tags/Gulp/" style="font-size: 12px;">Gulp</a> <a href="/tags/Javascript/" style="font-size: 20px;">Javascript</a> <a href="/tags/Jquery/" style="font-size: 18px;">Jquery</a> <a href="/tags/Life/" style="font-size: 12px;">Life</a> <a href="/tags/Logstash/" style="font-size: 12px;">Logstash</a> <a href="/tags/Machine-Learning/" style="font-size: 18px;">Machine Learning</a> <a href="/tags/Mysql/" style="font-size: 12px;">Mysql</a> <a href="/tags/Nginx/" style="font-size: 12px;">Nginx</a> <a href="/tags/NodeJs/" style="font-size: 12px;">NodeJs</a> <a href="/tags/Nodejs/" style="font-size: 16px;">Nodejs</a> <a href="/tags/Nvm/" style="font-size: 12px;">Nvm</a> <a href="/tags/OAuth/" style="font-size: 12px;">OAuth</a> <a href="/tags/PHP/" style="font-size: 14px;">PHP</a> <a href="/tags/Python/" style="font-size: 12px;">Python</a> <a href="/tags/Scrape/" style="font-size: 12px;">Scrape</a> <a href="/tags/TeamCity/" style="font-size: 12px;">TeamCity</a> <a href="/tags/Visual-Studio/" style="font-size: 12px;">Visual Studio</a>
    </div>
  </div>

  
    <div class="widget-wrap">
<h3 class="widget-title">Ads</h3>
<div class="widget">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
    <!-- saysua-sidebar-responsive -->
    <ins class="adsbygoogle"
         style="display:block"
         data-ad-client="ca-pub-4997068093676921"
         data-ad-slot="9242989898"
         data-ad-format="auto"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
</div>
</div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/03/27/download-file-bang-restangular-va-filesaver-js/">Download file bằng Restangular và FileSaver</a>
          </li>
        
          <li>
            <a href="/2017/02/08/ky-luat-la-tu-do/">Kỷ luật là tự do</a>
          </li>
        
          <li>
            <a href="/2016/12/17/nhung-chuc-nang-moi-cua-es6/">Những chức năng mới của ES6</a>
          </li>
        
          <li>
            <a href="/2016/12/04/push-nginx-log-to-elasticsearch-by-using-logstash/">Lưu log của nginx vào elastic search bằng logstash</a>
          </li>
        
          <li>
            <a href="/2016/12/01/chay-visual-studio-solution-tu-command-line/">Chạy Visual Studio Solution từ command line</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/03/">March 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/11/">November 2016</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/10/">October 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/04/">April 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/03/">March 2016</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/12/">December 2015</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/09/">September 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2015/08/">August 2015</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/10/">October 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2014/01/">January 2014</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/12/">December 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/11/">November 2013</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/10/">October 2013</a><span class="archive-list-count">4</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/09/">September 2013</a><span class="archive-list-count">3</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2013/08/">August 2013</a><span class="archive-list-count">2</span></li></ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Thach Nguyen<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a><br>
      Theme is based on <a href="http://demo.s5themes.com/focused/">Focused</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="http://app.saysua.com" class="mobile-nav-link">Apps</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    
<script>
  var disqus_shortname = 'saysua';
  
  var disqus_url = 'http://saysua.com/2013/11/05/viet-chuc-nang-upload-bang-ajax-voi-jquery-va-javascrip-chay/';
  
  (function(){
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>



<script src="/js/script.js"></script>

  </div>
</body>
</html>